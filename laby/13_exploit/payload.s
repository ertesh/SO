.text

main:
	pushl %ebp
	movl %esp, %ebp

	/* prepare arguments */
	pushl $0x0068732f /*/bin/sh*/
	pushl $0x6e69622f
	pushl $0
	pushl %esp

	/* push execve arguments on stack */	
	leal -8(%ebp), %ebx /*/bin/sh*/
	leal -12(%ebp), %ecx /*ptr to NULL*/
	leal -16(%ebp), %edx /*ptr to /bin/sh and then NULL*/
	pushl %ecx
	pushl %edx
	pushl %ebx

	/*call execve*/
	pushl %edx /*put some garbage instead of return address*/
	movl $0x3b, %eax /*mark execve syscall*/
	int $0x80 /*make the syscall*/

	/*not reached*/
	
.global main
